import{r as l,p as $,j as r,Q as c}from"./index-PDBVLXQN.js";import{S as w}from"./react-select.esm-QO7Mfydt.js";import"./FileSaver.min-C8VLTI_m.js";/* empty css                */import"./index-b66lgCNZ.js";import{U as O}from"./index-C4eFUQ8P.js";import"./xlsx-B1Xcmx07.js";const U=()=>{const[a,y]=l.useState([]),{userData:n,signOut:b}=$(),[m,f]=l.useState([]),[d,g]=l.useState([]),[x,S]=l.useState(null),[i,p]=l.useState([]);l.useState([]),l.useState([]);const[R,h]=l.useState(null);l.useState([]),l.useState([]),l.useState([]),l.useState(null),l.useEffect(()=>{j(),x&&P()},[a]);const j=()=>{fetch(`http://15.206.237.179:8000/api/clients/listofclient?filter=%7B%22search%22%3A%22%22%7D&access_token=${n==null?void 0:n.accessToken}`).then(async e=>{const o=await e.json();if(!e.ok){const t=o&&o.message||e.statusText;return Promise.reject(t)}f(o.data)}).catch(e=>{f([]),console.error("There was an error!",e),e==="Token Expired"&&b()})},T=m==null?void 0:m.map(e=>({data:e==null?void 0:e.client_id,label:e==null?void 0:e.client_name})),v=d==null?void 0:d.map(e=>({data:e==null?void 0:e.id,label:e==null?void 0:e.programName})),P=()=>{fetch(`http://15.206.237.179:8000/api/programs/listofProgramName?id=${x}&filter=%7B%22search%22%3A%22%22%7D&access_token=${n==null?void 0:n.accessToken}`).then(async e=>{const o=await e.json();if(!e.ok){const t=o&&o.message||e.statusText;return Promise.reject(t)}g(o.data)}).catch(e=>{g([]),console.error("There was an error!",e)})},N={container:e=>({...e,flex:1}),control:e=>({...e,border:"1px solid rgb(209 213 219)",boxShadow:"none","&:hover":{border:"1px solid rgb(17 24 39)"}}),input:e=>({...e,color:"rgb(75 85 99)",paddingLeft:"6px",paddingBottom:"3px",fontSize:"1rem",lineHeight:"1.25rem"}),placeholder:e=>({...e,color:"#a1a9bb",paddingLeft:"6px",fontSize:"0.870rem",lineHeight:"1.25rem"})},k=e=>{y(e),S(e.data),p([]),h(null)},E=e=>{p(e),h(e.data)},A=async()=>{if(a.length==0)return c.warn("No Client Name Selected");if(i.length==0)return c.warn("No Program Name Selected");var e=document.getElementById("generate");e.disabled=!0,e.className="h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-gray-500 cursor-not-allowed ",e.innerText="Please Wait...",console.log("selectedProgram.data++++++++++++++++++",i.data);const o={clientName:a.label,programName:i.label,programId:i.data};var t;let u=new URLSearchParams(Object.entries(o)).toString();t=await fetch(`http://15.206.237.179:8000/api/reports/attendanceReport?access_token=${n==null?void 0:n.accessToken}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:u});const s=await t.json();t.ok?s.code===404?console.error(s.msg):s!=null&&s.data?(c.success(s==null?void 0:s.message),C(s.data)):c.warn("No Reports Available!"):console.log("er")};function C(e){let o=[["Sr.No","Email","Name","Attendance Date","Training Name","Training Start Date","Training Start Time","Training End Date","Training End Time","Trainer Name","Venue Name"]];(n==null?void 0:n.client)==="kotak"&&o[0].splice(1,1),console.log("allExportAttendenceData",e),e.forEach((t,u)=>{let s=[u+1,(t==null?void 0:t.email)||"",(t==null?void 0:t.name)||"",(t==null?void 0:t.attendanceDate)||"",(t==null?void 0:t.trainingName)||"",(t==null?void 0:t.trainingStartDate)||"",(t==null?void 0:t.trainingStartTime)||"",(t==null?void 0:t.trainingEndDate)||"",(t==null?void 0:t.trainingEndTime)||"",(t==null?void 0:t.trainerName)||"-",(t==null?void 0:t.venueName)||"-"];(n==null?void 0:n.client)==="kotak"&&s.splice(1,1),o.push(s)}),console.log(o),O.exportAoaToXlsx(o,`Attendance-Report-${Date.now()}`)}return r.jsx(r.Fragment,{children:r.jsx("div",{className:"flex flex-col w-full min-h-screen ",children:r.jsxs("div",{className:"flex flex-col shadow-md rounded-md bg-white w-full h-fit mt-12  px-12",children:[r.jsx("label",{className:"leading-loose items-center justify-center flex w-full font-medium text-xl my-3 text-gray-700 text-center",children:"Generate Attendance report"}),r.jsxs("div",{className:"flex items-center  w-full ",children:[r.jsx("label",{className:"text-gray-700 font-medium text-md w-44",children:"Client Name*"}),r.jsx("div",{className:"relative focus-within:text-gray-600 w-full text-gray-400",children:r.jsx(w,{options:T,onChange:k,value:a,styles:N,getOptionValue:e=>e.data,placeholder:"Select Client"})}),r.jsx("input",{type:"text",name:"clientName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Client Name",required:!0,defaultValue:a==null?void 0:a.label})]}),r.jsxs("div",{className:"flex items-center  w-full mt-3",children:[r.jsx("label",{className:"text-gray-700 font-medium text-md w-44",children:"Program Name*"}),r.jsx("div",{className:"relative focus-within:text-gray-600 w-full text-gray-400",children:r.jsx(w,{options:v,onChange:E,value:i,styles:N,getOptionValue:e=>e.data,placeholder:"Select Program"})}),r.jsx("input",{type:"text",name:"programName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Program Name",required:!0,defaultValue:i.label})]}),r.jsx("div",{className:"flex items-start py-4 ",children:r.jsxs("div",{className:"flex flex-col items-left ml-4 w-1/2",children:[r.jsx("div",{className:"flex items-center w-full",children:r.jsx("input",{type:"text",name:"clientName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Client Name",required:!0,defaultValue:a==null?void 0:a.label})}),r.jsx("button",{onClick:()=>A(),id:"generate",className:"h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-green-500 cursor-pointer",children:"Generate Report"})]})})]})})})};export{U as default};
