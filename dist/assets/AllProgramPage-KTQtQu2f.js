import{r as t,p as I,m as Q,j as e,N as B,U as J,V as q,Q as O}from"./index-PDBVLXQN.js";import"./FileSaver.min-C8VLTI_m.js";import{D as G}from"./DeletePopCard-DGkzH1cc.js";import{v as H}from"./v4-D8aEg3BZ.js";function K({index:x,program:s,programManager:c,bucket:d,fetchProgramList:m,setBatchListPop:y,setId:k,setSelectedRow:N,setPopup:l}){const[p,j]=t.useState(!1),{userData:f,signOut:w}=I(),b=Q();t.useState("bg-sky-500 border-sky-500 hover:bg-sky-600"),t.useEffect(()=>{d.map(u=>(u.id==(s==null?void 0:s.id)&&j(!0),u))},[d]),console.log("---------------progrram",s);const g=new Date(s.programStartDate);s.programStartDate=g.toISOString().split("T")[0];const v=new Date(s.programEndDate);return s.programEndDate=v.toISOString().split("T")[0],e.jsx(e.Fragment,{children:e.jsxs("tr",{className:"bg-white border-b  odd:bg-white even:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 text-gray-900",children:e.jsx("button",{type:"button",onClick:()=>{b(`/program/${s==null?void 0:s.id}`)},className:`border  ${p?"bg-green-500 border-green-400 hover:bg-green-500":"bg-sky-500 border-sky-500 hover:bg-sky-600"} text-white rounded-md px-2 py-1  transition duration-75 ease select-none  focus:outline-none focus:shadow-outline`,children:p?"Added":"Add"})}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:s.programName}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:s.clientName}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:s.programType=="1"?"Open":s.programType=="0"?"Close":"-"}),e.jsx("td",{className:"px-6 text-gray-900",children:s.programStartDate}),e.jsx("td",{className:"px-6 text-gray-900",children:s.programEndDate}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:s.trainingType=="1"?"Class Room Training":s.trainingType=="2"?"Virtual Training":"-"}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:s.trainingType=="1"&&s.location?s.location:"-"}),e.jsx("td",{className:" flex  pl-10 flex-row px-6 py-4  mt-2",children:(f==null?void 0:f.userType)=="1"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-gray-700 mr-4 hover:underline cursor-pointer",children:e.jsx(B,{to:`/program/UpdateProgram/${s.id}`,children:e.jsx(J,{})})}),e.jsx("div",{className:"text-red-700 mr-4 hover:underline cursor-pointer",onClick:()=>{l(!0),N({title:s.programName,id:s.id})},children:e.jsx(q,{color:"red"})})]}):null})]})})}function W({programList:x,setBatchListPop:s,id:c,bucket:d,setBucket:m,setId:y,next:k,previous:N,pgindex:l,page:p,setLimit:j,setPage:f,setSearch:w,search:b,fetchProgramList:g}){const[v,u]=t.useState(!1),[P,T]=t.useState({title:"",id:""}),{userData:$,signOut:C}=I(),E=r=>{var n;if(d.length===0)m([r]);else if(d.map(o=>(o.id===r.id&&(n=!0),o)),n){const o=d.findIndex(D=>D.id===r.id);let h=[...d];o>=0?h.splice(o,1):console.warn(`Cannot remove : ${r.batchQuestionId}`),m(h)}else m([...d,r])},L=async()=>{try{const r=await fetch(`http://15.206.237.179:8000/api/programs/deleteProgram/${P.id}?access_token=${$.accessToken}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"Delete"}),n=await r.json();if(r.ok)n.code===400?O.error(n.msg):(O.success(n.msg),g(),u(!1));else throw n&&n.message||r.statusText}catch(r){console.error("There was an error!",r),(r==="Token Expired"||r==="Malformed User")&&C()}};return e.jsxs("div",{className:" space-y-4 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex flex-row my-4 justify-between items-center ",children:[e.jsx("div",{className:"px-2  flex w-full justify-between   ",children:e.jsx("h5",{className:"font-medium leading-none text-gray-700 ",children:"Add Program from Existing Programs"})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none py-2  ",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500 ",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),e.jsx("input",{value:b,type:"text",id:"table-search",className:"bg-gray-50 border py-1 outline-none border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-sky-500 focus:border-sky-500 block w-80 pl-10 p-2.5  ",placeholder:"Search by Program Name",onChange:r=>w(r.target.value)})]})]}),v?e.jsx("div",{className:"fixed z-30  w-full h-screen top-0 left-0 items-center   bg-gray-800/40",children:e.jsx("div",{className:"flex w-full items-start mt-10 justify-center ",children:e.jsxs("div",{className:"relative mx-20 flex flex-col  w-1/2 items-center justify-center bg-white rounded-lg shadow-md px-8 py-2",children:[e.jsx("div",{className:"absolute z-30 bg-white flex w-full justify-end items-end top-0  p-4 "}),e.jsx("div",{id:"journal-scroll",className:"w-full max-h-[32rem] h-fit overflow-y-auto mt-8",children:e.jsx(G,{title:P.title,cancelDelete:()=>u(!1),confirmDelete:()=>L(P.id)})})]})})}):null,e.jsx("div",{className:"relative overflow-x-auto shadow-md rounded-lg mt-3",children:e.jsxs("table",{className:"w-full text-sm text-left  text-gray-500",children:[e.jsx("thead",{className:"text-md m-4 bg-sky-600 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium",children:"View"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium",children:"Program Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium",children:"Client Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium ",children:"Type"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium ",children:"Start Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium ",children:"End Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium ",children:"Mode"}),e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium ",children:"Location"}),$.userType=="1"?e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium ",children:"Actions"}):e.jsx("th",{scope:"col",className:"px-6 py-3 font-medium "})]})}),e.jsx("tbody",{children:x.length==0?e.jsxs("tr",{className:"border-b  font-medium odd:bg-white even:bg-gray-50 ",children:[e.jsx("td",{className:"px-6 py-4"}),e.jsx("td",{className:"px-6 py-4",children:"No Program Data Found!! Create a new Program"}),e.jsx("td",{className:"px-6 py-4"})]}):e.jsx(e.Fragment,{children:x.map((r,n)=>e.jsx(K,{index:n,bucket:d,program:r,programManager:E,setId:y,setBatchListPop:s,setPopup:u,setSelectedRow:T},H()))})})]})}),e.jsxs("div",{className:"flex flex-row justify-around mt-2 items-center  ",children:[e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"dropdown flex items-center relative",children:[e.jsx("p",{children:"Show"}),e.jsx("span",{className:"bg-gray-100 text-gray-700 mx-2  font-normal tracking-wide rounded inline-flex items-center",children:e.jsxs("select",{className:"bg-transparent px-3 py-2  outline-none",onChange:r=>{j(r.target.value),f(1)},children:[e.jsx("option",{className:"mr-1 ",children:"5"}),e.jsx("option",{className:"mr-1 ",children:"10"}),e.jsx("option",{className:"mr-1 ",children:"20"}),e.jsx("option",{className:"mr-1 ",children:"30"}),e.jsx("option",{className:"mr-1 ",children:"40"}),e.jsx("option",{className:"mr-1 ",children:"50"})]})}),e.jsx("p",{children:"Programs"})]})}),e.jsxs("div",{children:[e.jsx("a",{onClick:()=>N(),className:` ${p===1?"hidden":"inline-flex items-center py-2 px-4 ml-3 text-sm font-medium text-gray-700 bg-gray-200 cursor-pointer rounded-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700   "}`,children:"Previous"}),e.jsx("a",{onClick:()=>k(),className:` ${p>=l?"hidden":"inline-flex items-center py-2 px-4 ml-3 text-sm font-medium text-gray-700 cursor-pointer bg-gray-200 rounded-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700   "}`,children:"Next"})]})]})]})}function X({id:x,setId:s,setBatchListPop:c,batchListPop:d}){const{userData:m,signOut:y}=I();t.useState(!1);const[k,N]=t.useState({}),[l,p]=t.useState(1);t.useState(0);const[j,f]=t.useState(1),[w,b]=t.useState(5),[g,v]=t.useState([]),[u,P]=t.useState([]),[T,$]=t.useState(""),C=()=>{fetch(`http://15.206.237.179:8000/api/programs/getProgramById/${x}?access_token=${m==null?void 0:m.accessToken}`).then(async n=>{const o=await n.json();if(console.log(o),!n.ok){const h=o&&o.message||n.statusText;return Promise.reject(h)}N(o.data)}).catch(n=>{N({}),console.error("There was an error!",n),(n==="Token Expired"||n==="Malformed User")&&y()})};t.useEffect(()=>{x&&C()},[x]);const E=async()=>{try{const o=encodeURIComponent(JSON.stringify({pageLimit:w,pageNo:l,search:T})),h=await fetch(`http://15.206.237.179:8000/api/programs/list?filter=${o}&access_token=${m==null?void 0:m.accessToken}`),D=await h.json();if(!h.ok)throw D.message;v(D.data.programs),f(D.data.lastPage)}catch(n){console.log(n),(n==="Malformed User"||n==="Token Expired")&&y()}},L=()=>{console.log(l),!(l>=j)&&p(l+1)},r=()=>{l<=1||p(l-1)};return t.useEffect(()=>{E()},[l,w,T]),e.jsx("div",{className:"flex flex-row w-full h-full space-x-5 py-5",children:e.jsx("div",{className:"flex w-full h-full rounded-lg",children:e.jsxs("div",{className:"flex w-full h-full bg-white rounded-[33px] flex-col",children:[e.jsx("span",{className:"flex cursor-pointer justify-between items-center p-3 text-sm font-medium text-gray-600 bg-gray-100 hover:underline border-t border-gray-200",children:e.jsx("div",{className:"float-right rounded-[33px] bg-sky-500 border-sky-500 hover:bg-sky-600 text-white rounded-md px-2 py-1  transition duration-75 ease select-none  focus:outline-none focus:shadow-outline",children:e.jsx(B,{to:"create-program",children:"Create New Program"})})}),e.jsx("div",{className:"w-full py-4 px-5",children:e.jsx(W,{setId:s,setBatchListPop:c,id:x,bucket:u,setBucket:P,programList:g,next:L,previous:r,pgindex:j,page:l,setPage:p,setLimit:b,setSearch:$,search:T,fetchProgramList:E})})]})})})}function re(){const[x,s]=t.useState(""),{userData:c,signOut:d}=I(),[m,y]=t.useState([]),[k,N]=t.useState(5),[l,p]=t.useState(0),[j,f]=t.useState(),[w,b]=t.useState(!1),[g,v]=t.useState(!1),[u,P]=t.useState(!1);t.useState();const[T,$]=t.useState(null),[C,E]=t.useState([]),[L,r]=t.useState([]),[n,o]=t.useState([]),[h,D]=t.useState(null),[M,U]=t.useState(null),[Y,A]=t.useState([]);t.useEffect(()=>{U(null),A([])},[g]);const R=()=>{fetch(`http://15.206.237.179:8000/api/Teams/getListofTeamsforbatch?filter=%7B%22limit%22%3A${k},%22start%22%3A${l},%22order%22%3A%22teamId%22,%22search%22%3A%22${x}%22%7D&access_token=${c==null?void 0:c.accessToken}`).then(async a=>{const i=await a.json();if(!a.ok){const S=i&&i.message||a.statusText;return Promise.reject(S)}y(i.data.list),f(i.data.totalCount)}).catch(a=>{y([]),console.error("There was an error!",a),(a==="Token Expired"||a==="Malformed User")&&d()})};t.useEffect(()=>{R()},[g,x,k,l]),t.useEffect(()=>{_(),o([]),A([])},[]),t.useEffect(()=>{h&&(z(),A([])),M&&F()},[h,M]);const _=()=>{fetch(`http://15.206.237.179:8000/api/clients/listofclient?filter=%7B%22search%22%3A%22%22%7D&access_token=${c==null?void 0:c.accessToken}`).then(async a=>{const i=await a.json();if(!a.ok){const S=i&&i.message||a.statusText;return Promise.reject(S)}r(i.data)}).catch(a=>{r([]),console.error("There was an error!",a),a==="Token Expired"&&d()})},z=()=>{fetch(`http://15.206.237.179:8000/api/projects/listofProgramName?id=${h}&filter=%7B%22search%22%3A%22%22%7D&access_token=${c==null?void 0:c.accessToken}`).then(async a=>{const i=await a.json();if(!a.ok){const S=i&&i.message||a.statusText;return Promise.reject(S)}o(i.data)}).catch(a=>{o([]),console.error("There was an error!",a),(a==="Token Expired"||a==="Malformed User")&&d()})},F=()=>{fetch(`http://15.206.237.179:8000/api/programTrainers/getprogramTrainersName?id=${M}&access_token=${c==null?void 0:c.accessToken}`).then(async a=>{const i=await a.json();if(!a.ok){const S=i&&i.message||a.statusText;return Promise.reject(S)}A(i.data)}).catch(a=>{A([]),console.error("There was an error!",a),(a==="Token Expired"||a==="Malformed User")&&d()})},V=j-5;return console.log(l,V),e.jsx("div",{className:"flex flex-col w-full mt-0 justify-center items-center ",children:e.jsx(X,{teamData:m,setBucket:E,setBatchPop:v,batchPop:g,schedulePop:w,setSchedulePop:b,setBatchListPop:P,id:T,batchListPop:u,setId:$,bucket:C})})}export{re as default};
