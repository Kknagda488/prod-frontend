import{r as t,p as C,a0 as E,j as r,Q as f}from"./index-PDBVLXQN.js";import{C as J,a as P}from"./CustomQuestionFeedback-Dcnwsr_e.js";import{v as R}from"./v4-D8aEg3BZ.js";const W=()=>{const[n,p]=t.useState([]),[i,v]=t.useState(null),[u,Q]=t.useState(null),[A,g]=t.useState("Loading..."),[m,k]=t.useState([]),[U,w]=t.useState(!1),[T,h]=t.useState({data:[],label:""}),[x,j]=t.useState(""),{userData:a,singOut:B}=C(),{batchId:I,asstype:_,assessmentId:d}=E();let S="updateAeessment";const b=e=>{var s=e,o=[];s.map(l=>{o=[...o,{...l,id:R()}]}),console.log(o,"opiuy"),N(o)},N=async e=>{var y;var s=JSON.stringify(e);console.log(s,"lhg");var o={type:u,QuestionBunch:s},l;let $=new URLSearchParams(Object.entries(o)).toString();console.log(o),l=await fetch(`http://15.206.237.179:8000/api/Assessments/updateAssessmentQuestions/${d}?access_token=${a==null?void 0:a.accessToken}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"PUT",body:$});const c=await l.json();console.log(c),l.ok?c.code===404?f.error(c.msg):(f.success("Questions Updated!!"),w(!0)):(console.log("er"),f.error((y=c==null?void 0:c.error)==null?void 0:y.message))},O=()=>{fetch(`http://15.206.237.179:8000/api/Assessments/getAsessmentById/${d}?access_token=${a==null?void 0:a.accessToken}`).then(async e=>{const s=await e.json();if(!e.ok){const o=s&&s.message||e.statusText;return g("Something went Wrong!!"),Promise.reject(o)}p(s.data),Q(s.data.assessmentType),v(!0)}).catch(e=>{p([]),g("Redirecting..."),console.error("There was an error!",e)})};return t.useEffect(()=>{O()},[d,i]),t.useEffect(()=>{if(i){var e=JSON.parse(n.questionBunchOfAssessment);if(k(e),u=="feedback"){var s=JSON.parse(n==null?void 0:n.description);h(s)}else h({data:"",label:n==null?void 0:n.description})}},[i]),console.log(m),u==null?r.jsx("div",{className:"flex flex-col justify-center items-center h-screen",children:r.jsx("h5",{className:"text-3xl font-semibold leading-none text-gray-700 ",children:A})}):u!=="feedback"?r.jsx("div",{className:"flex flex-col mt-5",children:r.jsx(J,{allQuestion:m,questionjson:i,setResult:b,updateAeessment:S,setName:j,name:x})}):r.jsx("div",{className:"flex flex-col mt-5",children:r.jsx(P,{allQuestion:m,questionjson:i,setResult:b,setName:j,updateAeessment:S,name:x,description:T})})};export{W as default};
