import{r as o,p as O,j as r,Q as u}from"./index-PDBVLXQN.js";import{S as b}from"./react-select.esm-QO7Mfydt.js";import"./FileSaver.min-C8VLTI_m.js";/* empty css                */import"./index-b66lgCNZ.js";import{U as M}from"./index-C4eFUQ8P.js";import"./xlsx-B1Xcmx07.js";const G=()=>{const[n,w]=o.useState([]),{userData:a,signOut:N}=O(),[i,d]=o.useState([]),[m,f]=o.useState([]),[h,j]=o.useState(null),[c,p]=o.useState([]);o.useState([]),o.useState([]);const[A,x]=o.useState(null);o.useState([]),o.useState([]),o.useState([{startDate:new Date,endDate:null,key:"selection"}]),o.useState([]),o.useState(null),o.useEffect(()=>{P(),h&&D()},[n]);const P=()=>{fetch(`http://15.206.237.179:8000/api/clients/listofclient?filter=%7B%22search%22%3A%22%22%7D&access_token=${a==null?void 0:a.accessToken}`).then(async e=>{const s=await e.json();if(!e.ok){const t=s&&s.message||e.statusText;return Promise.reject(t)}d(s.data)}).catch(e=>{d([]),console.error("There was an error!",e),e==="Token Expired"&&N()})},S=i==null?void 0:i.map(e=>({data:e==null?void 0:e.client_id,label:e==null?void 0:e.client_name})),v=m==null?void 0:m.map(e=>({data:e==null?void 0:e.id,label:e==null?void 0:e.programName})),D=()=>{fetch(`http://15.206.237.179:8000/api/programs/listofProgramName?id=${h}&filter=%7B%22search%22%3A%22%22%7D&access_token=${a==null?void 0:a.accessToken}`).then(async e=>{const s=await e.json();if(!e.ok){const t=s&&s.message||e.statusText;return Promise.reject(t)}f(s.data)}).catch(e=>{f([]),console.error("There was an error!",e)})},g={container:e=>({...e,flex:1}),control:e=>({...e,border:"1px solid rgb(209 213 219)",boxShadow:"none","&:hover":{border:"1px solid rgb(17 24 39)"}}),input:e=>({...e,color:"rgb(75 85 99)",paddingLeft:"6px",paddingBottom:"3px",fontSize:"1rem",lineHeight:"1.25rem"}),placeholder:e=>({...e,color:"#a1a9bb",paddingLeft:"6px",fontSize:"0.870rem",lineHeight:"1.25rem"})},B=e=>{w(e),j(e.data),p([]),x(null)},C=e=>{p(e),console.log("======================",e),x(e.data)},T=async()=>{if(n.length==0)return u.warn("No Client Name Selected");if(c.length==0)return u.warn("No Program Name Selected");var e=document.getElementById("generate");e.disabled=!0,e.className="h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-gray-500 cursor-not-allowed ",e.innerText="Please Wait...",console.log("selectedProgram.data++++++++++++++++++",c);const s={clientName:n.label,programName:c.label,programId:c.data};var t;let y=new URLSearchParams(Object.entries(s)).toString();t=await fetch(`http://15.206.237.179:8000/api/reports/participantsBasedReport?access_token=${a==null?void 0:a.accessToken}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:y});const l=await t.json();t.ok?l.code===404?console.error(l.msg):l!=null&&l.data?k(l.data):u.warn("No Reports Available!"):console.log("er"),e.disabled=!1,e.className="h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-green-500 cursor-pointer",e.innerText="Generate Report"};function k(e){let s=[["Program Name","Batches Name","Month","No. of batches","Count of attendance for both days","No.of Participants- Day-1","No.of Participants Day-2","Average Per batch participants on Day 1","Average Per batch participants on Day 2","% Change in participants M-O-M (Month of Month)","% Change in batches M-O-M"]];e.forEach((t,y)=>{let l=[t==null?void 0:t.programName,t==null?void 0:t.batch,t==null?void 0:t.Month,t==null?void 0:t.NoOfBatches,t==null?void 0:t.countBothDaysAttendace,t==null?void 0:t.noOfParticipantsDay1,t==null?void 0:t.noOfParticipantsDay2,t==null?void 0:t.averageBatchParticipantsDay1,t==null?void 0:t.averageBatchParticipantsDay2,t==null?void 0:t.changeInParticipantsMom,t==null?void 0:t.changeInBatchesMom];s.push(l)}),console.log(s),M.exportAoaToXlsx(s,`Summery-Report-${Date.now()}`)}return r.jsx(r.Fragment,{children:r.jsx("div",{className:"flex flex-col w-full min-h-screen ",children:r.jsxs("div",{className:"flex flex-col shadow-md rounded-md bg-white w-full h-fit mt-12  px-12",children:[r.jsx("label",{className:"leading-loose items-center justify-center flex w-full font-medium text-xl my-3 text-gray-700 text-center",children:"Generate Participants Based Report"}),r.jsxs("div",{className:"flex items-center  w-full ",children:[r.jsx("label",{className:"text-gray-700 font-medium text-md w-44",children:"Client Name*"}),r.jsx("div",{className:"relative focus-within:text-gray-600 w-full text-gray-400",children:r.jsx(b,{options:S,onChange:B,value:n,styles:g,getOptionValue:e=>e.data,placeholder:"Select Client"})}),r.jsx("input",{type:"text",name:"clientName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Client Name",required:!0,defaultValue:n==null?void 0:n.label})]}),r.jsxs("div",{className:"flex items-center  w-full mt-3",children:[r.jsx("label",{className:"text-gray-700 font-medium text-md w-44",children:"Program Name*"}),r.jsxs("div",{className:"relative focus-within:text-gray-600 w-full text-gray-400",children:[console.log(),r.jsx(b,{options:v,onChange:C,value:c,styles:g,getOptionValue:e=>e.data,placeholder:"Select Program"})]}),r.jsx("input",{type:"text",name:"programName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Program Name",required:!0,defaultValue:c.label})]}),r.jsx("div",{className:"flex items-start py-4 ",children:r.jsxs("div",{className:"flex flex-col items-left ml-4 w-1/2",children:[r.jsx("div",{className:"flex items-center w-full",children:r.jsx("input",{type:"text",name:"clientName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Client Name",required:!0,defaultValue:n==null?void 0:n.label})}),r.jsx("button",{onClick:()=>T(),id:"generate",className:"h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-green-500 cursor-pointer",children:"Generate Report"})]})})]})})})};export{G as default};
