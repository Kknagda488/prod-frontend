import{r as n,p as O,j as t,Q as c}from"./index-PDBVLXQN.js";import{S as b}from"./react-select.esm-QO7Mfydt.js";import"./FileSaver.min-C8VLTI_m.js";/* empty css                */import"./index-b66lgCNZ.js";import{U as R}from"./index-C4eFUQ8P.js";import"./xlsx-B1Xcmx07.js";const z=()=>{const[a,w]=n.useState([]),{userData:r,signOut:N}=O(),[d,u]=n.useState([]),[m,f]=n.useState([]),[p,y]=n.useState(null),[l,g]=n.useState([]);n.useState([]),n.useState([]);const[I,x]=n.useState(null);n.useEffect(()=>{P(),p&&v()},[a]);const P=()=>{fetch(`http://15.206.237.179:8000/api/clients/listofclient?filter=%7B%22search%22%3A%22%22%7D&access_token=${r==null?void 0:r.accessToken}`).then(async e=>{const s=await e.json();if(!e.ok){const o=s&&s.message||e.statusText;return Promise.reject(o)}u(s.data)}).catch(e=>{u([]),console.error("There was an error!",e),e==="Token Expired"&&N()})},j=d==null?void 0:d.map(e=>({data:e==null?void 0:e.client_id,label:e==null?void 0:e.client_name})),S=m==null?void 0:m.map(e=>({data:e==null?void 0:e.id,label:e==null?void 0:e.programName})),v=()=>{fetch(`http://15.206.237.179:8000/api/programs/listofProgramName?id=${p}&filter=%7B%22search%22%3A%22%22%7D&access_token=${r==null?void 0:r.accessToken}`).then(async e=>{const s=await e.json();if(!e.ok){const o=s&&s.message||e.statusText;return Promise.reject(o)}f(s.data)}).catch(e=>{f([]),console.error("There was an error!",e)})},h={container:e=>({...e,flex:1}),control:e=>({...e,border:"1px solid rgb(209 213 219)",boxShadow:"none","&:hover":{border:"1px solid rgb(17 24 39)"}}),input:e=>({...e,color:"rgb(75 85 99)",paddingLeft:"6px",paddingBottom:"3px",fontSize:"1rem",lineHeight:"1.25rem"}),placeholder:e=>({...e,color:"#a1a9bb",paddingLeft:"6px",fontSize:"0.870rem",lineHeight:"1.25rem"})},A=e=>{w(e),y(e.data),g([]),x(null)},C=e=>{g(e),x(e.data)},k=async()=>{if(a.length==0)return c.warn("No Client Name Selected");if(l.length==0)return c.warn("No Program Name Selected");var e=document.getElementById("generate");e.disabled=!0,e.className="h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-gray-500 cursor-not-allowed ",e.innerText="Please Wait...",console.log("selectedProgram.data++++++++++++++++++",l.data);const s={clientName:a.label,programName:l.label,programId:l.data};var o;let $=new URLSearchParams(Object.entries(s)).toString();o=await fetch(`http://15.206.237.179:8000/api/reports/assessmentScore?access_token=${r==null?void 0:r.accessToken}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:$});const i=await o.json();o.ok?i.code===404?console.error(i.msg):i?(c.success("report fetch success"),T(i)):c.warn("No Reports Available!"):console.log("er")},T=e=>{const s=[["Program",e.programName],["",""],["",""],["Nominated",e.totalNominated],["Present as per attendance criteria",e.presentAttendanceCriteria],[`Present as per attendance criteria 
 and attempted final assessment`,e.presentAttendanceAndAttemptedAssessment],["Final Assessment Passed",e.finalAssessmentPassed],[`Attempted final assessment but have
 not qualified the attendance criteria`,e.attemptedAssessmentNotQualifiedAttendance],[`Present as per attendance criteria but
 not attempted final day assessment`,e.presentAttendanceNotAttemptedAssessment],["Overall Attendance %",e.overallAttendancePercentage],["Assessment Cleared by %",e.assessmentClearedPercentage],[`Attendance qualified Participants 
who scored => 60%`,e.attendanceQualifiedParticipants60Percent],[`% Participants in 60% 
or above bucket`,e.participants60PercentAndAbove]];console.log("programName",e),console.log(s),R.exportAoaToXlsx(s,`Attendance-Report-${Date.now()}`)};return t.jsx(t.Fragment,{children:t.jsx("div",{className:"flex flex-col w-full min-h-screen ",children:t.jsxs("div",{className:"flex flex-col shadow-md rounded-md bg-white w-full h-fit mt-12  px-12",children:[t.jsx("label",{className:"leading-loose items-center justify-center flex w-full font-medium text-xl my-3 text-gray-700 text-center",children:"Generate Assessment Report"}),t.jsxs("div",{className:"flex items-center  w-full ",children:[t.jsx("label",{className:"text-gray-700 font-medium text-md w-44",children:"Client Name*"}),t.jsx("div",{className:"relative focus-within:text-gray-600 w-full text-gray-400",children:t.jsx(b,{options:j,onChange:A,value:a,styles:h,getOptionValue:e=>e.data,placeholder:"Select Client"})}),t.jsx("input",{type:"text",name:"clientName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Client Name",required:!0,defaultValue:a==null?void 0:a.label})]}),t.jsxs("div",{className:"flex items-center  w-full mt-3",children:[t.jsx("label",{className:"text-gray-700 font-medium text-md w-44",children:"Program Name*"}),t.jsx("div",{className:"relative focus-within:text-gray-600 w-full text-gray-400",children:t.jsx(b,{options:S,onChange:C,value:l,styles:h,getOptionValue:e=>e.data,placeholder:"Select Program"})}),t.jsx("input",{type:"text",name:"programName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Program Name",required:!0,defaultValue:l.label})]}),t.jsx("div",{className:"flex items-start py-4 ",children:t.jsxs("div",{className:"flex flex-col items-left ml-4 w-1/2",children:[t.jsx("div",{className:"flex items-center w-full",children:t.jsx("input",{type:"text",name:"clientName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Client Name",required:!0,defaultValue:a==null?void 0:a.label})}),t.jsx("button",{onClick:()=>k(),id:"generate",className:"h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-green-500 cursor-pointer",children:"Generate Report"})]})})]})})})};export{z as default};
