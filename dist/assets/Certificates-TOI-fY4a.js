import{r as c,p as E,j as e,q as T,Q as o}from"./index-PDBVLXQN.js";import{r as D}from"./readXlsxFileBrowser-5wfj6eDS.js";function Y({session:F}){const[y,d]=c.useState("Select a file..."),{userData:a}=E(),[N,v]=c.useState([]),[m,h]=c.useState([]),[f,g]=c.useState(!1),[i,x]=c.useState(1),[u,b]=c.useState(1),[p,w]=c.useState(30),S=s=>{s.target.files.length&&(d(s.target.files[0].name),D(s.target.files[0]).then(l=>{l.shift();let n=[];l.forEach((t,r)=>{let $={name:t[0],email:t[1],programName:t[2],programDate:t[3],programDate2:t[4]};n.push($)}),h(n)}))},k=async s=>{var t;s.preventDefault();try{if(!m.length){o.error("Please provide users.");return}g(!0);var l,n=JSON.stringify(m);console.log("======================================================",m,"-------------------------------------------",n),l=await fetch(`http://15.206.237.179:8000/api/certificates/generate-certificate?access_token=${a==null?void 0:a.accessToken}`,{headers:{"Content-Type":"application/json"},method:"POST",body:n});const r=await l.json();l.ok?r.status==="failure"?o.error(r.msg):(o.success(r.msg),d("Select a file..."),h([]),s.target.reset(),j()):o.error((t=r==null?void 0:r.error)==null?void 0:t.message)}catch(r){console.log(r)}finally{g(!1)}},C=()=>{console.log(i),!(i>=u)&&x(i+1)},P=()=>{i<=1||x(i-1)},j=async()=>{try{const l=encodeURIComponent(JSON.stringify({pageLimit:p,pageNo:i})),n=await fetch(`http://15.206.237.179:8000/api/certificates/list?filter=${l}&access_token=${a==null?void 0:a.accessToken}`);if(!n.ok){const r=t&&t.message||n.statusText;return Promise.reject(r)}const t=await n.json();v(t.data.certifiates),b(t.data.lastPage)}catch(s){console.error("There was an error!",s)}};return c.useEffect(()=>{j()},[p,i]),e.jsxs("div",{className:"flex flex-col w-full h-full",children:[e.jsxs("form",{onSubmit:k,children:[e.jsx("div",{className:"flex flex-col w-full mt-1",children:e.jsx("div",{className:"grid grid-cols-1",children:e.jsx("div",{className:"flex flex-col",children:e.jsxs("span",{htmlFor:"files",className:"relative flex w-full items-center bg-gray-200 rounded-md cursor-pointer ",children:[e.jsx("input",{id:"files",name:"files",className:"absolute w-full opacity-0",type:"file",onChange:S,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"}),e.jsx("span",{className:"flex rounded-l-lg py-2 text-sm px-5 h-full bg-sky-500 text-white w-fit",children:"Upload user list"}),e.jsx("p",{className:"text-sm font-medium  px-6 text-gray-700",children:y})]})})})}),e.jsx("div",{className:"pt-4 flex  space-x-4",children:e.jsx("button",{type:"submit",disabled:f,className:"bg-sky-500 flex justify-center items-center w-100 text-white px-4 py-2 rounded-md focus:outline-none",children:f?e.jsx("span",{children:"Generating..."}):e.jsx("span",{children:"Generate"})})})]}),e.jsx("h5",{className:" text-md font-medium tracking-wide my-2 text-gray-700 lg:text-xl ",children:"Certificate data"}),e.jsx("div",{className:"relative overflow-x-auto shadow-md sm:rounded-lg mt-3",children:e.jsxs("table",{className:"w-full text-sm text-left text-gray-500 ",children:[e.jsx("thead",{className:"text-md m-4 bg-sky-600 text-white   ",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Program Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Program Date"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Certificate File"})]})}),e.jsx("tbody",{children:N.map((s,l)=>e.jsxs("tr",{className:"bg-white border-b",children:[e.jsx("th",{scope:"row",className:"flex flex-row items-center px-6 py-4 font-medium text-gray-900  w-44",children:s==null?void 0:s.name}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:s==null?void 0:s.email}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:s==null?void 0:s.programName}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:s!=null&&s.programDate?T(s==null?void 0:s.programDate).format("DD-MM-YYYY"):"-"}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:s!=null&&s.response?JSON.parse(s==null?void 0:s.response).accepted.length?e.jsx("span",{className:"inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20",children:"success"}):e.jsx("span",{classNam:"inline-flex items-center rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-700 ring-1 ring-inset ring-red-600/10",children:"Failed"}):"-"}),e.jsx("td",{className:"px-6 py-4 text-gray-900",children:e.jsx("a",{href:s==null?void 0:s.file,target:"_blank",rel:"noreferrer",children:"View File"})})]},l+1))})]})}),e.jsxs("div",{className:"flex flex-row justify-around mt-10 items-center  ",children:[e.jsx("span",{className:"text-sm flex text-gray-700 "}),e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"dropdown flex items-center relative",children:[e.jsx("p",{children:"Show"}),e.jsx("span",{className:"bg-gray-100 text-gray-700 mx-2  font-normal tracking-wide rounded inline-flex items-center",children:e.jsxs("select",{className:"bg-transparent px-3 py-2  outline-none ",value:p,onChange:s=>{w(s.target.value),x(1)},children:[e.jsx("option",{className:"mr-1",children:"5"}),e.jsx("option",{className:"mr-1",children:"10"}),e.jsx("option",{className:"mr-1",children:"20"}),e.jsx("option",{className:"mr-1",children:"30"}),e.jsx("option",{className:"mr-1",children:"40"}),e.jsx("option",{className:"mr-1",children:"50"}),e.jsx("option",{className:"mr-1",children:"100"}),e.jsx("option",{className:"mr-1",children:"250"}),e.jsx("option",{className:"mr-1",children:"500"})]})}),e.jsx("p",{children:"Entries"})]})}),e.jsxs("div",{children:[e.jsx("a",{onClick:()=>P(),className:` ${i===1?"hidden":"inline-flex items-center py-2 px-4 ml-3 text-sm font-medium text-gray-700 bg-gray-200 cursor-pointer rounded-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700   "}`,children:"Previous"}),e.jsx("a",{onClick:()=>C(),className:` ${i>=u?"hidden":"inline-flex items-center py-2 px-4 ml-3 text-sm font-medium text-gray-700 cursor-pointer bg-gray-200 rounded-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700   "}`,children:"Next"})]})]})]})}export{Y as default};
