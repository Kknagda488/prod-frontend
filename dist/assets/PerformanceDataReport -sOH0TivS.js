import{r as c,p as A,j as r,Q as i}from"./index-PDBVLXQN.js";import{S as b}from"./react-select.esm-QO7Mfydt.js";import"./FileSaver.min-C8VLTI_m.js";/* empty css                */import{U as E}from"./index-C4eFUQ8P.js";import"./xlsx-B1Xcmx07.js";const G=()=>{const[o,y]=c.useState([]),{userData:s,signOut:N}=A(),[m,f]=c.useState([]),[d,x]=c.useState([]),[p,j]=c.useState(null),[l,h]=c.useState([]),[O,g]=c.useState(null);c.useEffect(()=>{S(),p&&T()},[o]);const S=()=>{fetch(`http://15.206.237.179:8000/api/clients/listofclient?filter=%7B%22search%22%3A%22%22%7D&access_token=${s==null?void 0:s.accessToken}`).then(async e=>{const a=await e.json();if(!e.ok){const t=a&&a.message||e.statusText;return Promise.reject(t)}f(a.data)}).catch(e=>{f([]),console.error("There was an error!",e),e==="Token Expired"&&N()})},P=m==null?void 0:m.map(e=>({data:e==null?void 0:e.client_id,label:e==null?void 0:e.client_name})),v=d==null?void 0:d.map(e=>({data:e==null?void 0:e.id,label:e==null?void 0:e.programName})),T=()=>{fetch(`http://15.206.237.179:8000/api/programs/listofProgramName?id=${p}&filter=%7B%22search%22%3A%22%22%7D&access_token=${s==null?void 0:s.accessToken}`).then(async e=>{const a=await e.json();if(!e.ok){const t=a&&a.message||e.statusText;return Promise.reject(t)}x(a.data)}).catch(e=>{x([]),console.error("There was an error!",e)})},w={container:e=>({...e,flex:1}),control:e=>({...e,border:"1px solid rgb(209 213 219)",boxShadow:"none","&:hover":{border:"1px solid rgb(17 24 39)"}}),input:e=>({...e,color:"rgb(75 85 99)",paddingLeft:"6px",paddingBottom:"3px",fontSize:"1rem",lineHeight:"1.25rem"}),placeholder:e=>({...e,color:"#a1a9bb",paddingLeft:"6px",fontSize:"0.870rem",lineHeight:"1.25rem"})},k=e=>{y(e),j(e.data),h([]),g(null)},C=e=>{h(e),g(e.data)},R=async()=>{if(o.length==0)return i.warn("No Client Name Selected");if(l.length==0)return i.warn("No Program Name Selected");var e=document.getElementById("generate");e.disabled=!0,e.className="h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-gray-500 cursor-not-allowed ",e.innerText="Please Wait...",console.log("selectedProgram.data++++++++++++++++++",l.data);const a={clientName:o.label,programName:l.label,programId:l.data};var t;let u=new URLSearchParams(Object.entries(a)).toString();t=await fetch(`http://15.206.237.179:8000/api/reports/participantsPerformanceDataReport?access_token=${s==null?void 0:s.accessToken}`,{headers:{"Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:u});const n=await t.json();t.ok?n.code===404?i.error(n.msg||n.message):n?(i.success("Report fetch successfully "),$(n)):i.warn("No Reports Available!"):console.log("er"),e.disabled=!1,e.className="h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-green-500 cursor-pointer",e.innerText="Generate Report"},$=e=>{let a=[["Sr.No","Month","Total Participants who took the assessment","Total Participants who scored > 80%","% of participants with > 80% Marks"]];e.forEach((t,u)=>{let n=[u+1,(t==null?void 0:t.month)||"",(t==null?void 0:t.totalNomineeAssessmentTook)||0,(t==null?void 0:t.topNominees80Scored)||0,(t==null?void 0:t.percentageScore)||"0%"];a.push(n)}),console.log(a),E.exportAoaToXlsx(a,`Attendance-Report-${Date.now()}`)};return console.log(l==null?void 0:l.data,"S"),r.jsx(r.Fragment,{children:r.jsx("div",{className:"flex flex-col w-full min-h-screen ",children:r.jsxs("div",{className:"flex flex-col shadow-md rounded-md bg-white w-full h-fit mt-12  px-12",children:[r.jsx("label",{className:"leading-loose items-center justify-center flex w-full font-medium text-xl my-3 text-gray-700 text-center",children:"Generate Participants' Performance Report"}),r.jsxs("div",{className:"flex items-center  w-full ",children:[r.jsx("label",{className:"text-gray-700 font-medium text-md w-44",children:"Client Name*"}),r.jsx("div",{className:"relative focus-within:text-gray-600 w-full text-gray-400",children:r.jsx(b,{options:P,onChange:k,value:o,styles:w,getOptionValue:e=>e.data,placeholder:"Select Client"})}),r.jsx("input",{type:"text",name:"clientName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Client Name",required:!0,defaultValue:o==null?void 0:o.label})]}),r.jsxs("div",{className:"flex items-center  w-full mt-3",children:[r.jsx("label",{className:"text-gray-700 font-medium text-md w-44",children:"Program Name*"}),r.jsx("div",{className:"relative focus-within:text-gray-600 w-full text-gray-400",children:r.jsx(b,{options:v,onChange:C,value:l,styles:w,getOptionValue:e=>e.data,placeholder:"Select Program"})}),r.jsx("input",{type:"text",name:"programName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Program Name",required:!0,defaultValue:l.label})]}),r.jsx("div",{className:"flex items-start py-4 ",children:r.jsxs("div",{className:"flex flex-col items-left ml-4 w-1/2",children:[r.jsx("div",{className:"flex items-center w-full",children:r.jsx("input",{type:"text",name:"clientName",className:"hidden px-4 py-2 border focus:ring-gray-500 focus:border-gray-900 w-full sm:text-sm border-gray-300 rounded-md focus:outline-none text-gray-600",placeholder:"Client Name",required:!0,defaultValue:o==null?void 0:o.label})}),r.jsx("button",{onClick:()=>R(),id:"generate",className:"h-8 mt-4 w-fit px-6 ml-8 text-white rounded-md bg-green-500 cursor-pointer",children:"Generate Report"})]})})]})})})};export{G as default};
